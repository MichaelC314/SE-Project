import { BackendOutputClientFactory, } from '@aws-amplify/deployed-backend-client';
import { graphqlOutputKey } from '@aws-amplify/backend-output-schemas';
import { AppsyncGraphqlGenerationResult } from './appsync_graphql_generation_result.js';
import { StackMetadataGraphqlModelsGenerator } from './graphql_models_generator.js';
import { S3StringObjectFetcher } from './s3_string_object_fetcher.js';
import { getBackendOutputWithErrorHandling } from './get_backend_output_with_error_handling.js';
/**
 * Factory function to compose a model generator.
 */
export const createGraphqlModelsGenerator = (params) => {
    if ('backendIdentifier' in params) {
        return createGraphqlModelsGeneratorFromBackendIdentifier(params);
    }
    return createGraphqlModelsFromS3UriGenerator(params);
};
/**
 * Factory function to compose a model generator from a backend identifier.
 */
const createGraphqlModelsGeneratorFromBackendIdentifier = ({ backendIdentifier, awsClientProvider, }) => {
    if (!backendIdentifier) {
        // eslint-disable-next-line amplify-backend-rules/prefer-amplify-errors
        throw new Error('`backendIdentifier` must be defined');
    }
    if (!awsClientProvider) {
        // eslint-disable-next-line amplify-backend-rules/prefer-amplify-errors
        throw new Error('`awsClientProvider` must be defined');
    }
    return new StackMetadataGraphqlModelsGenerator(() => getModelSchema(backendIdentifier, awsClientProvider), (fileMap) => new AppsyncGraphqlGenerationResult(fileMap));
};
/**
 * Factory function to compose a model generator from an s3 uri.
 */
export const createGraphqlModelsFromS3UriGenerator = ({ modelSchemaS3Uri, awsClientProvider, }) => {
    if (!modelSchemaS3Uri) {
        // eslint-disable-next-line amplify-backend-rules/prefer-amplify-errors
        throw new Error('`modelSchemaS3Uri` must be defined');
    }
    if (!awsClientProvider) {
        // eslint-disable-next-line amplify-backend-rules/prefer-amplify-errors
        throw new Error('`awsClientProvider` must be defined');
    }
    return new StackMetadataGraphqlModelsGenerator(() => getModelSchemaFromS3Uri(modelSchemaS3Uri, awsClientProvider), (fileMap) => new AppsyncGraphqlGenerationResult(fileMap));
};
const getModelSchema = async (backendIdentifier, awsClientProvider) => {
    const backendOutputClient = BackendOutputClientFactory.getInstance(awsClientProvider);
    const output = await getBackendOutputWithErrorHandling(backendOutputClient, backendIdentifier);
    const modelSchemaS3Uri = output[graphqlOutputKey]?.payload.amplifyApiModelSchemaS3Uri;
    if (!modelSchemaS3Uri) {
        // eslint-disable-next-line amplify-backend-rules/prefer-amplify-errors
        throw new Error(`Cannot find model schema at amplifyApiModelSchemaS3Uri`);
    }
    return await getModelSchemaFromS3Uri(modelSchemaS3Uri, awsClientProvider);
};
const getModelSchemaFromS3Uri = async (modelSchemaS3Uri, awsClientProvider) => {
    const schemaFetcher = new S3StringObjectFetcher(awsClientProvider.getS3Client());
    return await schemaFetcher.fetch(modelSchemaS3Uri);
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY3JlYXRlX2dyYXBocWxfbW9kZWxzX2dlbmVyYXRvci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uL3NyYy9jcmVhdGVfZ3JhcGhxbF9tb2RlbHNfZ2VuZXJhdG9yLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFDTCwwQkFBMEIsR0FFM0IsTUFBTSxzQ0FBc0MsQ0FBQztBQUU5QyxPQUFPLEVBQUUsZ0JBQWdCLEVBQUUsTUFBTSxxQ0FBcUMsQ0FBQztBQUN2RSxPQUFPLEVBQUUsOEJBQThCLEVBQUUsTUFBTSx3Q0FBd0MsQ0FBQztBQUN4RixPQUFPLEVBQUUsbUNBQW1DLEVBQUUsTUFBTSwrQkFBK0IsQ0FBQztBQUVwRixPQUFPLEVBQUUscUJBQXFCLEVBQUUsTUFBTSwrQkFBK0IsQ0FBQztBQUt0RSxPQUFPLEVBQUUsaUNBQWlDLEVBQUUsTUFBTSw2Q0FBNkMsQ0FBQztBQW9CaEc7O0dBRUc7QUFDSCxNQUFNLENBQUMsTUFBTSw0QkFBNEIsR0FBRyxDQUMxQyxNQUEyQyxFQUNuQixFQUFFO0lBQzFCLElBQUksbUJBQW1CLElBQUksTUFBTSxFQUFFO1FBQ2pDLE9BQU8saURBQWlELENBQUMsTUFBTSxDQUFDLENBQUM7S0FDbEU7SUFDRCxPQUFPLHFDQUFxQyxDQUFDLE1BQU0sQ0FBQyxDQUFDO0FBQ3ZELENBQUMsQ0FBQztBQVdGOztHQUVHO0FBQ0gsTUFBTSxpREFBaUQsR0FBRyxDQUFDLEVBQ3pELGlCQUFpQixFQUNqQixpQkFBaUIsR0FDd0IsRUFBMEIsRUFBRTtJQUNyRSxJQUFJLENBQUMsaUJBQWlCLEVBQUU7UUFDdEIsdUVBQXVFO1FBQ3ZFLE1BQU0sSUFBSSxLQUFLLENBQUMscUNBQXFDLENBQUMsQ0FBQztLQUN4RDtJQUNELElBQUksQ0FBQyxpQkFBaUIsRUFBRTtRQUN0Qix1RUFBdUU7UUFDdkUsTUFBTSxJQUFJLEtBQUssQ0FBQyxxQ0FBcUMsQ0FBQyxDQUFDO0tBQ3hEO0lBRUQsT0FBTyxJQUFJLG1DQUFtQyxDQUM1QyxHQUFHLEVBQUUsQ0FBQyxjQUFjLENBQUMsaUJBQWlCLEVBQUUsaUJBQWlCLENBQUMsRUFDMUQsQ0FBQyxPQUFPLEVBQUUsRUFBRSxDQUFDLElBQUksOEJBQThCLENBQUMsT0FBTyxDQUFDLENBQ3pELENBQUM7QUFDSixDQUFDLENBQUM7QUFXRjs7R0FFRztBQUNILE1BQU0sQ0FBQyxNQUFNLHFDQUFxQyxHQUFHLENBQUMsRUFDcEQsZ0JBQWdCLEVBQ2hCLGlCQUFpQixHQUM0QixFQUEwQixFQUFFO0lBQ3pFLElBQUksQ0FBQyxnQkFBZ0IsRUFBRTtRQUNyQix1RUFBdUU7UUFDdkUsTUFBTSxJQUFJLEtBQUssQ0FBQyxvQ0FBb0MsQ0FBQyxDQUFDO0tBQ3ZEO0lBQ0QsSUFBSSxDQUFDLGlCQUFpQixFQUFFO1FBQ3RCLHVFQUF1RTtRQUN2RSxNQUFNLElBQUksS0FBSyxDQUFDLHFDQUFxQyxDQUFDLENBQUM7S0FDeEQ7SUFDRCxPQUFPLElBQUksbUNBQW1DLENBQzVDLEdBQUcsRUFBRSxDQUFDLHVCQUF1QixDQUFDLGdCQUFnQixFQUFFLGlCQUFpQixDQUFDLEVBQ2xFLENBQUMsT0FBTyxFQUFFLEVBQUUsQ0FBQyxJQUFJLDhCQUE4QixDQUFDLE9BQU8sQ0FBQyxDQUN6RCxDQUFDO0FBQ0osQ0FBQyxDQUFDO0FBRUYsTUFBTSxjQUFjLEdBQUcsS0FBSyxFQUMxQixpQkFBNEMsRUFDNUMsaUJBSUUsRUFDZSxFQUFFO0lBQ25CLE1BQU0sbUJBQW1CLEdBQ3ZCLDBCQUEwQixDQUFDLFdBQVcsQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDO0lBQzVELE1BQU0sTUFBTSxHQUFHLE1BQU0saUNBQWlDLENBQ3BELG1CQUFtQixFQUNuQixpQkFBaUIsQ0FDbEIsQ0FBQztJQUNGLE1BQU0sZ0JBQWdCLEdBQ3BCLE1BQU0sQ0FBQyxnQkFBZ0IsQ0FBQyxFQUFFLE9BQU8sQ0FBQywwQkFBMEIsQ0FBQztJQUMvRCxJQUFJLENBQUMsZ0JBQWdCLEVBQUU7UUFDckIsdUVBQXVFO1FBQ3ZFLE1BQU0sSUFBSSxLQUFLLENBQUMsd0RBQXdELENBQUMsQ0FBQztLQUMzRTtJQUVELE9BQU8sTUFBTSx1QkFBdUIsQ0FBQyxnQkFBZ0IsRUFBRSxpQkFBaUIsQ0FBQyxDQUFDO0FBQzVFLENBQUMsQ0FBQztBQUVGLE1BQU0sdUJBQXVCLEdBQUcsS0FBSyxFQUNuQyxnQkFBd0IsRUFDeEIsaUJBRUUsRUFDZSxFQUFFO0lBQ25CLE1BQU0sYUFBYSxHQUFHLElBQUkscUJBQXFCLENBQzdDLGlCQUFpQixDQUFDLFdBQVcsRUFBRSxDQUNoQyxDQUFDO0lBQ0YsT0FBTyxNQUFNLGFBQWEsQ0FBQyxLQUFLLENBQUMsZ0JBQWdCLENBQUMsQ0FBQztBQUNyRCxDQUFDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBCYWNrZW5kT3V0cHV0Q2xpZW50RmFjdG9yeSxcbiAgRGVwbG95ZWRCYWNrZW5kSWRlbnRpZmllcixcbn0gZnJvbSAnQGF3cy1hbXBsaWZ5L2RlcGxveWVkLWJhY2tlbmQtY2xpZW50JztcblxuaW1wb3J0IHsgZ3JhcGhxbE91dHB1dEtleSB9IGZyb20gJ0Bhd3MtYW1wbGlmeS9iYWNrZW5kLW91dHB1dC1zY2hlbWFzJztcbmltcG9ydCB7IEFwcHN5bmNHcmFwaHFsR2VuZXJhdGlvblJlc3VsdCB9IGZyb20gJy4vYXBwc3luY19ncmFwaHFsX2dlbmVyYXRpb25fcmVzdWx0LmpzJztcbmltcG9ydCB7IFN0YWNrTWV0YWRhdGFHcmFwaHFsTW9kZWxzR2VuZXJhdG9yIH0gZnJvbSAnLi9ncmFwaHFsX21vZGVsc19nZW5lcmF0b3IuanMnO1xuaW1wb3J0IHsgR3JhcGhxbE1vZGVsc0dlbmVyYXRvciB9IGZyb20gJy4vbW9kZWxfZ2VuZXJhdG9yLmpzJztcbmltcG9ydCB7IFMzU3RyaW5nT2JqZWN0RmV0Y2hlciB9IGZyb20gJy4vczNfc3RyaW5nX29iamVjdF9mZXRjaGVyLmpzJztcbmltcG9ydCB7IEFXU0NsaWVudFByb3ZpZGVyIH0gZnJvbSAnQGF3cy1hbXBsaWZ5L3BsdWdpbi10eXBlcyc7XG5pbXBvcnQgeyBTM0NsaWVudCB9IGZyb20gJ0Bhd3Mtc2RrL2NsaWVudC1zMyc7XG5pbXBvcnQgeyBBbXBsaWZ5Q2xpZW50IH0gZnJvbSAnQGF3cy1zZGsvY2xpZW50LWFtcGxpZnknO1xuaW1wb3J0IHsgQ2xvdWRGb3JtYXRpb25DbGllbnQgfSBmcm9tICdAYXdzLXNkay9jbGllbnQtY2xvdWRmb3JtYXRpb24nO1xuaW1wb3J0IHsgZ2V0QmFja2VuZE91dHB1dFdpdGhFcnJvckhhbmRsaW5nIH0gZnJvbSAnLi9nZXRfYmFja2VuZF9vdXRwdXRfd2l0aF9lcnJvcl9oYW5kbGluZy5qcyc7XG5cbmV4cG9ydCB0eXBlIEdyYXBocWxNb2RlbHNHZW5lcmF0b3JGYWN0b3J5UGFyYW1zID1cbiAgfCB7XG4gICAgICBiYWNrZW5kSWRlbnRpZmllcjogRGVwbG95ZWRCYWNrZW5kSWRlbnRpZmllcjtcbiAgICAgIGF3c0NsaWVudFByb3ZpZGVyOiBBV1NDbGllbnRQcm92aWRlcjx7XG4gICAgICAgIGdldFMzQ2xpZW50OiBTM0NsaWVudDtcbiAgICAgICAgZ2V0QW1wbGlmeUNsaWVudDogQW1wbGlmeUNsaWVudDtcbiAgICAgICAgZ2V0Q2xvdWRGb3JtYXRpb25DbGllbnQ6IENsb3VkRm9ybWF0aW9uQ2xpZW50O1xuICAgICAgfT47XG4gICAgfVxuICB8IHtcbiAgICAgIG1vZGVsU2NoZW1hUzNVcmk6IHN0cmluZztcbiAgICAgIGF3c0NsaWVudFByb3ZpZGVyOiBBV1NDbGllbnRQcm92aWRlcjx7XG4gICAgICAgIGdldFMzQ2xpZW50OiBTM0NsaWVudDtcbiAgICAgICAgZ2V0QW1wbGlmeUNsaWVudDogQW1wbGlmeUNsaWVudDtcbiAgICAgICAgZ2V0Q2xvdWRGb3JtYXRpb25DbGllbnQ6IENsb3VkRm9ybWF0aW9uQ2xpZW50O1xuICAgICAgfT47XG4gICAgfTtcblxuLyoqXG4gKiBGYWN0b3J5IGZ1bmN0aW9uIHRvIGNvbXBvc2UgYSBtb2RlbCBnZW5lcmF0b3IuXG4gKi9cbmV4cG9ydCBjb25zdCBjcmVhdGVHcmFwaHFsTW9kZWxzR2VuZXJhdG9yID0gKFxuICBwYXJhbXM6IEdyYXBocWxNb2RlbHNHZW5lcmF0b3JGYWN0b3J5UGFyYW1zLFxuKTogR3JhcGhxbE1vZGVsc0dlbmVyYXRvciA9PiB7XG4gIGlmICgnYmFja2VuZElkZW50aWZpZXInIGluIHBhcmFtcykge1xuICAgIHJldHVybiBjcmVhdGVHcmFwaHFsTW9kZWxzR2VuZXJhdG9yRnJvbUJhY2tlbmRJZGVudGlmaWVyKHBhcmFtcyk7XG4gIH1cbiAgcmV0dXJuIGNyZWF0ZUdyYXBocWxNb2RlbHNGcm9tUzNVcmlHZW5lcmF0b3IocGFyYW1zKTtcbn07XG5cbmV4cG9ydCB0eXBlIEdyYXBocWxNb2RlbHNGcm9tQmFja2VuZElkZW50aWZpZXJQYXJhbXMgPSB7XG4gIGJhY2tlbmRJZGVudGlmaWVyOiBEZXBsb3llZEJhY2tlbmRJZGVudGlmaWVyO1xuICBhd3NDbGllbnRQcm92aWRlcjogQVdTQ2xpZW50UHJvdmlkZXI8e1xuICAgIGdldFMzQ2xpZW50OiBTM0NsaWVudDtcbiAgICBnZXRBbXBsaWZ5Q2xpZW50OiBBbXBsaWZ5Q2xpZW50O1xuICAgIGdldENsb3VkRm9ybWF0aW9uQ2xpZW50OiBDbG91ZEZvcm1hdGlvbkNsaWVudDtcbiAgfT47XG59O1xuXG4vKipcbiAqIEZhY3RvcnkgZnVuY3Rpb24gdG8gY29tcG9zZSBhIG1vZGVsIGdlbmVyYXRvciBmcm9tIGEgYmFja2VuZCBpZGVudGlmaWVyLlxuICovXG5jb25zdCBjcmVhdGVHcmFwaHFsTW9kZWxzR2VuZXJhdG9yRnJvbUJhY2tlbmRJZGVudGlmaWVyID0gKHtcbiAgYmFja2VuZElkZW50aWZpZXIsXG4gIGF3c0NsaWVudFByb3ZpZGVyLFxufTogR3JhcGhxbE1vZGVsc0Zyb21CYWNrZW5kSWRlbnRpZmllclBhcmFtcyk6IEdyYXBocWxNb2RlbHNHZW5lcmF0b3IgPT4ge1xuICBpZiAoIWJhY2tlbmRJZGVudGlmaWVyKSB7XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGFtcGxpZnktYmFja2VuZC1ydWxlcy9wcmVmZXItYW1wbGlmeS1lcnJvcnNcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ2BiYWNrZW5kSWRlbnRpZmllcmAgbXVzdCBiZSBkZWZpbmVkJyk7XG4gIH1cbiAgaWYgKCFhd3NDbGllbnRQcm92aWRlcikge1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBhbXBsaWZ5LWJhY2tlbmQtcnVsZXMvcHJlZmVyLWFtcGxpZnktZXJyb3JzXG4gICAgdGhyb3cgbmV3IEVycm9yKCdgYXdzQ2xpZW50UHJvdmlkZXJgIG11c3QgYmUgZGVmaW5lZCcpO1xuICB9XG5cbiAgcmV0dXJuIG5ldyBTdGFja01ldGFkYXRhR3JhcGhxbE1vZGVsc0dlbmVyYXRvcihcbiAgICAoKSA9PiBnZXRNb2RlbFNjaGVtYShiYWNrZW5kSWRlbnRpZmllciwgYXdzQ2xpZW50UHJvdmlkZXIpLFxuICAgIChmaWxlTWFwKSA9PiBuZXcgQXBwc3luY0dyYXBocWxHZW5lcmF0aW9uUmVzdWx0KGZpbGVNYXApLFxuICApO1xufTtcblxuZXhwb3J0IHR5cGUgR3JhcGhxbE1vZGVsc0Zyb21TM1VyaUdlbmVyYXRvckZhY3RvcnlQYXJhbXMgPSB7XG4gIG1vZGVsU2NoZW1hUzNVcmk6IHN0cmluZztcbiAgYXdzQ2xpZW50UHJvdmlkZXI6IEFXU0NsaWVudFByb3ZpZGVyPHtcbiAgICBnZXRTM0NsaWVudDogUzNDbGllbnQ7XG4gICAgZ2V0QW1wbGlmeUNsaWVudDogQW1wbGlmeUNsaWVudDtcbiAgICBnZXRDbG91ZEZvcm1hdGlvbkNsaWVudDogQ2xvdWRGb3JtYXRpb25DbGllbnQ7XG4gIH0+O1xufTtcblxuLyoqXG4gKiBGYWN0b3J5IGZ1bmN0aW9uIHRvIGNvbXBvc2UgYSBtb2RlbCBnZW5lcmF0b3IgZnJvbSBhbiBzMyB1cmkuXG4gKi9cbmV4cG9ydCBjb25zdCBjcmVhdGVHcmFwaHFsTW9kZWxzRnJvbVMzVXJpR2VuZXJhdG9yID0gKHtcbiAgbW9kZWxTY2hlbWFTM1VyaSxcbiAgYXdzQ2xpZW50UHJvdmlkZXIsXG59OiBHcmFwaHFsTW9kZWxzRnJvbVMzVXJpR2VuZXJhdG9yRmFjdG9yeVBhcmFtcyk6IEdyYXBocWxNb2RlbHNHZW5lcmF0b3IgPT4ge1xuICBpZiAoIW1vZGVsU2NoZW1hUzNVcmkpIHtcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgYW1wbGlmeS1iYWNrZW5kLXJ1bGVzL3ByZWZlci1hbXBsaWZ5LWVycm9yc1xuICAgIHRocm93IG5ldyBFcnJvcignYG1vZGVsU2NoZW1hUzNVcmlgIG11c3QgYmUgZGVmaW5lZCcpO1xuICB9XG4gIGlmICghYXdzQ2xpZW50UHJvdmlkZXIpIHtcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgYW1wbGlmeS1iYWNrZW5kLXJ1bGVzL3ByZWZlci1hbXBsaWZ5LWVycm9yc1xuICAgIHRocm93IG5ldyBFcnJvcignYGF3c0NsaWVudFByb3ZpZGVyYCBtdXN0IGJlIGRlZmluZWQnKTtcbiAgfVxuICByZXR1cm4gbmV3IFN0YWNrTWV0YWRhdGFHcmFwaHFsTW9kZWxzR2VuZXJhdG9yKFxuICAgICgpID0+IGdldE1vZGVsU2NoZW1hRnJvbVMzVXJpKG1vZGVsU2NoZW1hUzNVcmksIGF3c0NsaWVudFByb3ZpZGVyKSxcbiAgICAoZmlsZU1hcCkgPT4gbmV3IEFwcHN5bmNHcmFwaHFsR2VuZXJhdGlvblJlc3VsdChmaWxlTWFwKSxcbiAgKTtcbn07XG5cbmNvbnN0IGdldE1vZGVsU2NoZW1hID0gYXN5bmMgKFxuICBiYWNrZW5kSWRlbnRpZmllcjogRGVwbG95ZWRCYWNrZW5kSWRlbnRpZmllcixcbiAgYXdzQ2xpZW50UHJvdmlkZXI6IEFXU0NsaWVudFByb3ZpZGVyPHtcbiAgICBnZXRTM0NsaWVudDogUzNDbGllbnQ7XG4gICAgZ2V0QW1wbGlmeUNsaWVudDogQW1wbGlmeUNsaWVudDtcbiAgICBnZXRDbG91ZEZvcm1hdGlvbkNsaWVudDogQ2xvdWRGb3JtYXRpb25DbGllbnQ7XG4gIH0+LFxuKTogUHJvbWlzZTxzdHJpbmc+ID0+IHtcbiAgY29uc3QgYmFja2VuZE91dHB1dENsaWVudCA9XG4gICAgQmFja2VuZE91dHB1dENsaWVudEZhY3RvcnkuZ2V0SW5zdGFuY2UoYXdzQ2xpZW50UHJvdmlkZXIpO1xuICBjb25zdCBvdXRwdXQgPSBhd2FpdCBnZXRCYWNrZW5kT3V0cHV0V2l0aEVycm9ySGFuZGxpbmcoXG4gICAgYmFja2VuZE91dHB1dENsaWVudCxcbiAgICBiYWNrZW5kSWRlbnRpZmllcixcbiAgKTtcbiAgY29uc3QgbW9kZWxTY2hlbWFTM1VyaSA9XG4gICAgb3V0cHV0W2dyYXBocWxPdXRwdXRLZXldPy5wYXlsb2FkLmFtcGxpZnlBcGlNb2RlbFNjaGVtYVMzVXJpO1xuICBpZiAoIW1vZGVsU2NoZW1hUzNVcmkpIHtcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgYW1wbGlmeS1iYWNrZW5kLXJ1bGVzL3ByZWZlci1hbXBsaWZ5LWVycm9yc1xuICAgIHRocm93IG5ldyBFcnJvcihgQ2Fubm90IGZpbmQgbW9kZWwgc2NoZW1hIGF0IGFtcGxpZnlBcGlNb2RlbFNjaGVtYVMzVXJpYCk7XG4gIH1cblxuICByZXR1cm4gYXdhaXQgZ2V0TW9kZWxTY2hlbWFGcm9tUzNVcmkobW9kZWxTY2hlbWFTM1VyaSwgYXdzQ2xpZW50UHJvdmlkZXIpO1xufTtcblxuY29uc3QgZ2V0TW9kZWxTY2hlbWFGcm9tUzNVcmkgPSBhc3luYyAoXG4gIG1vZGVsU2NoZW1hUzNVcmk6IHN0cmluZyxcbiAgYXdzQ2xpZW50UHJvdmlkZXI6IEFXU0NsaWVudFByb3ZpZGVyPHtcbiAgICBnZXRTM0NsaWVudDogUzNDbGllbnQ7XG4gIH0+LFxuKTogUHJvbWlzZTxzdHJpbmc+ID0+IHtcbiAgY29uc3Qgc2NoZW1hRmV0Y2hlciA9IG5ldyBTM1N0cmluZ09iamVjdEZldGNoZXIoXG4gICAgYXdzQ2xpZW50UHJvdmlkZXIuZ2V0UzNDbGllbnQoKSxcbiAgKTtcbiAgcmV0dXJuIGF3YWl0IHNjaGVtYUZldGNoZXIuZmV0Y2gobW9kZWxTY2hlbWFTM1VyaSk7XG59O1xuIl19